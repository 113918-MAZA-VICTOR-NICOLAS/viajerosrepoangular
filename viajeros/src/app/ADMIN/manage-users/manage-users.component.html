<!-- reintegros.component.html -->
<div class="container">
    <h2 class="mt-4">Usuarios</h2>
    <p>Podes hacer modificaciones en el usuario</p>
    <hr class="my-4">
    <div class="container mt-4">

        <!-- Tabla de Usuarios -->
        <table class="table table-striped text-center">
            <thead>
                <tr>
                    <th>ID Usuario</th>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Teléfono</th>
                    <th>Fecha de Registro</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of filteredUsers">
                    <td>{{ user.idUser }}</td>
                    <td>{{ user.name }} {{ user.lastname }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.phone }}</td>
                    <td>{{ user.registrationDate | date: 'dd/MM/yyyy' }}</td>
                    <td>
                        <span [ngClass]="{'text-success': !user.deleted, 'text-danger': user.deleted}">
                            {{ user.deleted ? 'Inactivo' : 'Activo' }}
                        </span>
                    </td>
                    <td>
                        <!-- Dropdown de Acciones -->
                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="accionesDropdown"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Acciones
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="accionesDropdown">
                                <li><a class="dropdown-item" (click)="editarUsuario(user)"  data-bs-toggle="modal" data-bs-target="#roleModal">Editar</a></li>
                                <li><a class="dropdown-item" (click)="eliminarUsuario(user)">Eliminar</a></li>
                                <li><a class="dropdown-item" (click)="cambiarRol(user)">Cambiar Rol</a></li>
                                <li>
                                    <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#blockUserModal">Bloquear</a>
                                  </li>
                                  
                            </ul>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>




  <!-- modal bloquear -->

<div class="modal fade" id="blockUserModal" tabindex="-1" aria-labelledby="blockUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="blockUserModalLabel">Bloquear Usuario</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>¿Estás seguro de que deseas bloquear a este usuario?</p>
          <div class="mb-3">
            <label for="comment" class="form-label">Comentario:</label>
            <textarea [(ngModel)]="commentblock" id="comment" class="form-control" rows="3" placeholder="Razón del bloqueo"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="blockUser()">Bloquear</button>
        </div>
      </div>
    </div>
  </div>
  



  <!-- Modal -->
<div class="modal fade" id="roleModal" tabindex="-1" aria-labelledby="roleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="roleModalLabel">Editar Rol del Usuario</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="roleSelect" class="form-label">Seleccione el Rol:</label>
            <select class="form-select" id="roleSelect">
              <option value="1">Administrador</option>
              <option value="2">Usuario</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary" (click)="changeUserRole()">Guardar Cambios</button>
      </div>
    </div>
  </div>
</div>
